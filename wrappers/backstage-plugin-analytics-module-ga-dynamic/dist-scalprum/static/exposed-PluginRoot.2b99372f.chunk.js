"use strict";(self.webpackChunkrafaeltuelho_backstage_plugin_analytics_module_ga_dynamic=self.webpackChunkrafaeltuelho_backstage_plugin_analytics_module_ga_dynamic||[]).push([[879],{683:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=t||"";return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(o=t.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,(function(e,t,a){return t>0&&t+e.length!==a.length&&e.search(n)>-1&&":"!==a.charAt(t-2)&&("-"!==a.charAt(t+e.length)||"-"===a.charAt(t-1))&&a.charAt(t-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)}))),r&&(o=function(e){return"string"==typeof e&&-1!==e.indexOf("@")}(e=o)?(console.warn("This arg looks like an email address, redacting."),a):e),o};var n=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i,a="REDACTED (Potential Email Address)"},874:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var a=c(n(507)),r=c(n(683)),o=["eventCategory","eventAction","eventLabel","eventValue","hitType"],i=["title","location"],s=["page","hitType"];function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,h(a.key),a)}}function m(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!==u(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}var b=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"reset",(function(){t.isInitialized=!1,t._testMode=!1,t._currentMeasurementId,t._hasLoadedGA=!1,t._isQueuing=!1,t._queueGtag=[]})),m(this,"_gtag",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t._testMode||t._isQueuing?t._queueGtag.push(n):a.default.apply(void 0,n)})),m(this,"_loadGA",(function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://www.googletagmanager.com/gtag/js";if("undefined"!=typeof window&&"undefined"!=typeof document&&!t._hasLoadedGA){var r=document.createElement("script");r.async=!0,r.src="".concat(a,"?id=").concat(e),n&&r.setAttribute("nonce",n),document.body.appendChild(r),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},t._hasLoadedGA=!0}})),m(this,"_toGtagOptions",(function(e){if(e){var t={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"};return Object.entries(e).reduce((function(e,n){var a,r,o=(r=2,function(e){if(Array.isArray(e))return e}(a=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(s.push(a.value),s.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return s}}(a,r)||f(a,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],s=o[1];return t[i]?e[t[i]]=s:e[i]=s,e}),{})}})),m(this,"initialize",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("Require GA_MEASUREMENT_ID");var a="string"==typeof e?[{trackingId:e}]:e;t._currentMeasurementId=a[0].trackingId;var r=n.gaOptions,o=n.gtagOptions,i=n.nonce,s=n.testMode,c=void 0!==s&&s,l=n.gtagUrl;if(t._testMode=c,c||t._loadGA(t._currentMeasurementId,i,l),t.isInitialized||(t._gtag("js",new Date),a.forEach((function(e){var n=p(p(p({},t._toGtagOptions(p(p({},r),e.gaOptions))),o),e.gtagOptions);Object.keys(n).length?t._gtag("config",e.trackingId,n):t._gtag("config",e.trackingId)}))),t.isInitialized=!0,!c){var u=d(t._queueGtag);for(t._queueGtag=[],t._isQueuing=!1;u.length;){var g=u.shift();t._gtag.apply(t,d(g)),"get"===g[0]&&(t._isQueuing=!0)}}})),m(this,"set",(function(e){e?"object"===u(e)?(0===Object.keys(e).length&&console.warn("empty `fieldsObject` given to .set()"),t._gaCommand("set",e)):console.warn("Expected `fieldsObject` arg to be an Object"):console.warn("`fieldsObject` is required in .set()")})),m(this,"_gaCommandSendEvent",(function(e,n,a,r,o){t._gtag("event",n,p(p({event_category:e,event_label:a,value:r},o&&{non_interaction:o.nonInteraction}),t._toGtagOptions(o)))})),m(this,"_gaCommandSendEventParameters",(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if("string"==typeof n[0])t._gaCommandSendEvent.apply(t,d(n.slice(1)));else{var r=n[0],i=r.eventCategory,s=r.eventAction,c=r.eventLabel,u=r.eventValue,g=(r.hitType,l(r,o));t._gaCommandSendEvent(i,s,c,u,g)}})),m(this,"_gaCommandSendTiming",(function(e,n,a,r){t._gtag("event","timing_complete",{name:n,value:a,event_category:e,event_label:r})})),m(this,"_gaCommandSendPageview",(function(e,n){if(n&&Object.keys(n).length){var a=t._toGtagOptions(n),r=a.title,o=a.location,s=l(a,i);t._gtag("event","page_view",p(p(p(p({},e&&{page_path:e}),r&&{page_title:r}),o&&{page_location:o}),s))}else e?t._gtag("event","page_view",{page_path:e}):t._gtag("event","page_view")})),m(this,"_gaCommandSendPageviewParameters",(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if("string"==typeof n[0])t._gaCommandSendPageview.apply(t,d(n.slice(1)));else{var r=n[0],o=r.page,i=(r.hitType,l(r,s));t._gaCommandSendPageview(o,i)}})),m(this,"_gaCommandSend",(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r="string"==typeof n[0]?n[0]:n[0].hitType;switch(r){case"event":t._gaCommandSendEventParameters.apply(t,n);break;case"pageview":t._gaCommandSendPageviewParameters.apply(t,n);break;case"timing":t._gaCommandSendTiming.apply(t,d(n.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(r));break;default:console.warn("Send command doesn't exist: ".concat(r))}})),m(this,"_gaCommandSet",(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];"string"==typeof n[0]&&(n[0]=m({},n[0],n[1])),t._gtag("set",t._toGtagOptions(n[0]))})),m(this,"_gaCommand",(function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];switch(e){case"send":t._gaCommandSend.apply(t,a);break;case"set":t._gaCommandSet.apply(t,a);break;default:console.warn("Command doesn't exist: ".concat(e))}})),m(this,"ga",(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if("string"==typeof n[0])t._gaCommand.apply(t,n);else{var r=n[0];t._gtag("get",t._currentMeasurementId,"client_id",(function(e){t._isQueuing=!1;var n=t._queueGtag;for(r({get:function(n){return"clientId"===n?e:"trackingId"===n?t._currentMeasurementId:"apiVersion"===n?"1":void 0}});n.length;){var a=n.shift();t._gtag.apply(t,d(a))}})),t._isQueuing=!0}return t.ga})),m(this,"event",(function(e,n){if("string"==typeof e)t._gtag("event",e,t._toGtagOptions(n));else{var a=e.action,o=e.category,i=e.label,s=e.value,c=e.nonInteraction,l=e.transport;if(!o||!a)return void console.warn("args.category AND args.action are required in event()");var u={hitType:"event",eventCategory:(0,r.default)(o),eventAction:(0,r.default)(a)};i&&(u.eventLabel=(0,r.default)(i)),void 0!==s&&("number"!=typeof s?console.warn("Expected `args.value` arg to be a Number."):u.eventValue=s),void 0!==c&&("boolean"!=typeof c?console.warn("`args.nonInteraction` must be a boolean."):u.nonInteraction=c),void 0!==l&&("string"!=typeof l?console.warn("`args.transport` must be a string."):(-1===["beacon","xhr","image"].indexOf(l)&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),u.transport=l)),t._gaCommand("send",u)}})),m(this,"send",(function(e){t._gaCommand("send",e)})),this.reset()}var t,n;return t=e,n=[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.GA4=b;var _=new b;t.default=_},507:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a;"undefined"!=typeof window&&(void 0===window.gtag&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(a=window).gtag.apply(a,t))}},970:(e,t,n)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.Ay=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var c=i?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(r,s,c):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(n(874));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}r.GA4;var i=r.default;t.Ay=i},506:(e,t,n)=>{n.r(t),n.d(t,{GoogleAnalyticsApi:()=>u});var a=n(97),r=n(970),o=Object.defineProperty;class i{constructor({defer:e=!1}){var t,n;((e,t,n)=>{t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(this,"symbol"!=typeof(t="queue")?t+"":t,n),this.queue=e?[]:void 0}setReady(){this.queue&&(this.queue.forEach(this.sendDeferred),this.queue=void 0)}event(e,t={}){const n={...e,...t};this.queue?this.queue.push({hitType:e.action,data:{...n,timestamp_micros:1e3*Date.now()}}):r.Ay.event(e.action,n)}sendDeferred(e){r.Ay.event(e.hitType,{...e.data})}}var s=Object.defineProperty,c=(e,t,n)=>(((e,t,n)=>{t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class l{constructor(e){c(this,"customUserIdTransform"),c(this,"capture"),c(this,"contentGroupBy"),c(this,"allowedContexts"),c(this,"allowedAttributes");const{identity:t,measurementId:n,identityApi:a,userIdTransform:o="sha-256",testMode:s,debug:l,enableSendPageView:u,contentGroupBy:d,allowedContexts:g,allowedAttributes:p}=e;r.Ay.initialize(n,{testMode:s,gaOptions:{debug_mode:l},gtagOptions:{debug_mode:l,send_page_view:u}}),this.contentGroupBy=d,this.allowedAttributes=p,this.allowedContexts=g,this.capture=new i({defer:"required"===t}),this.customUserIdTransform="function"==typeof o?o:void 0,"disabled"!==t&&a&&this.setUserFrom(a).then((()=>{}))}static fromConfig(e,t={}){var n,a,r;const o=e.getString("app.analytics.ga4.measurementId"),i=e.getOptionalString("app.analytics.ga4.identity")||"disabled",s=null!=(n=e.getOptionalBoolean("app.analytics.ga4.debug"))&&n,c=null!=(a=e.getOptionalBoolean("app.analytics.ga4.enableSendPageView"))&&a,u=null!=(r=e.getOptionalBoolean("app.analytics.ga4.testMode"))&&r,d=e.getOptionalString("app.analytics.ga4.contentGrouping"),g=e.getOptionalStringArray("app.analytics.ga4.allowedContexts"),p=e.getOptionalStringArray("app.analytics.ga4.allowedAttributes");if("required"===i&&!t.identityApi)throw new Error("Invalid config: identity API must be provided to deps when ga4.identity is required");return new l({...t,identity:i,measurementId:o,testMode:u,debug:s,enableSendPageView:c,contentGroupBy:d,allowedContexts:g,allowedAttributes:p})}captureEvent(e){const{context:t,action:n,subject:a,value:r,attributes:o}=e,i=this.setEventParameters(t,o);this.contentGroupBy&&(i.content_group=t[this.contentGroupBy]);const s=t.extensionId||t.extension,c=s?String(s):"App";"navigate"===n&&c.toLocaleLowerCase("en-US").startsWith("app")?this.capture.event({category:c,action:"page_view",label:a,value:r},i):("search"===n&&(i.search_term=a),this.capture.event({category:c,action:n,label:a,value:r},i))}setEventParameters(e,t={}){var n,a;const r={},o="*"===(null==(n=this.allowedContexts)?void 0:n.join(""))?Object.keys(e):this.allowedContexts;null==o||o.forEach((t=>{e[t]&&(r[`c_${t}`]=e[t])}));const i="*"===(null==(a=this.allowedAttributes)?void 0:a.join(""))?Object.keys(t):this.allowedAttributes;return null==i||i.forEach((e=>{t[e]&&(r[`a_${e}`]=t[e])})),r}async setUserFrom(e){const{userEntityRef:t}=await e.getBackstageIdentity(),n=await this.getPrivateUserId(t);r.Ay.set({user_id:n}),this.capture.setReady()}getPrivateUserId(e){return this.customUserIdTransform?this.customUserIdTransform(e):this.hash(e)}async hash(e){const t=await window.crypto.subtle.digest("sha-256",(new TextEncoder).encode(e));return Array.from(new Uint8Array(t)).map((e=>e.toString(16).padStart(2,"0"))).join("")}}const u=(0,a.createApiFactory)({api:a.analyticsApiRef,deps:{configApi:a.configApiRef,identityApi:a.identityApiRef},factory:({configApi:e,identityApi:t})=>l.fromConfig(e,{identityApi:t})})}}]);
//# sourceMappingURL=exposed-PluginRoot.2b99372f.chunk.js.map